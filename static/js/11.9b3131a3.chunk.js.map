{"version":3,"sources":["Components/Uploader.tsx","Views/Home.tsx","Model/Controller.tsx","Store/User.tsx","Store/Auth.tsx","Store/Image.tsx","Store/History.tsx","Store/index.tsx","Components/Header.tsx","Components/Layout.tsx"],"names":["Dragger","Upload","Wrapper","styled","div","StyledDragger","UpLoader","observer","useStore","UserStore","ImageStore","props","beforeUpload","file","setFile","setFileName","name","currentUser","message","warning","test","type","size","error","saveFile","then","console","log","catch","err","alert","JSON","stringify","className","InboxOutlined","StyleImg","img","H1","h1","big","keyframes","StyleDiv","Result","Home","history","useHistory","widthRef","useRef","heightRef","store","useLocalStore","width","setWidth","this","height","setHeight","serveFile","attributes","url","heightStr","widthStr","Layout","onClick","push","src","rel","href","placeholder","ref","onChange","current","value","AllStr","AV","init","appId","appKey","serverURL","Auth","register","userName","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","login","logIn","response","logout","logOut","getCurrent","Uploader","add","fileName","item","Object","avFile","File","set","save","find","page","limit","query","Query","include","skip","descending","equalTo","results","observable","action","values","passWord","pullUser","resetUser","filename","newFile","isUpLoading","finally","newList","list","concat","isLoading","append","length","hasMore","success","context","createContext","AuthStore","HistoryStore","useContext","Text","StyledEntry","StyleNavLink","NavLink","Header","useEffect","to","activeClassName","exact","username","Main","children"],"mappings":"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","file":"static/js/11.9b3131a3.chunk.js","sourcesContent":["import React from \"react\";\r\nimport {Upload, message} from \"antd\";\r\nimport {InboxOutlined} from \"@ant-design/icons\";\r\nimport {useStore} from \"../Store\";\r\nimport styled from \"styled-components\";\r\nimport {observer} from \"mobx-react\";\r\n\r\n\r\n\r\nconst {Dragger} = Upload;\r\n\r\n\r\nconst Wrapper = styled.div`\r\nmax-width: 1000px;\r\nmargin: 50px auto;\r\n`;\r\nconst StyledDragger = styled(Dragger)`\r\n  &.bgGround {\r\n    background:rgba(241, 243, 244,0.4) ;\r\n\r\n  }\r\n`;\r\n\r\nconst UpLoader = observer(() => {\r\n    const {UserStore, ImageStore} = useStore();\r\n\r\n  const props = {\r\n      beforeUpload: (file: File) => {\r\n        ImageStore.setFile(file);\r\n        ImageStore.setFileName(file.name);\r\n        if (UserStore.currentUser === null) {\r\n          message.warning(\" 请先登录在上传\");\r\n          return false;\r\n        }\r\n        if (!(/.(jpg|jpeg|png|gif|svg)$/.test(file.type))){\r\n          message.error('不是支持的格式')\r\n          return false\r\n        }\r\n        if(file.size>1024*1024){\r\n          message.error('上传图片过大')\r\n          return false\r\n        }\r\n          ImageStore.saveFile().then(() => {\r\n            console.log(\"上传成功\");\r\n          }).catch(err => {\r\n            console.log(\"上传失败\");\r\n            alert(JSON.stringify(err));\r\n          });\r\n\r\n        return false;\r\n      },\r\n    };\r\n    return (\r\n      <Wrapper>\r\n        <StyledDragger {...props} className=\"bgGround\">\r\n          <p className=\"ant-upload-drag-icon\">\r\n            <InboxOutlined/>\r\n          </p>\r\n          <p className=\"ant-upload-text\">点击拖拽上传文件</p>\r\n          <p className=\"ant-upload-hint\">\r\n            Support for a single or bulk upload. Strictly prohibit from uploading company data or other\r\n            band files\r\n          </p>\r\n        </StyledDragger>\r\n\r\n      </Wrapper>\r\n    );\r\n  }\r\n);\r\n\r\nexport {UpLoader};","import React, {useRef} from \"react\";\r\nimport {Layout} from \"../Components/Layout\";\r\nimport {useStore} from \"../Store\";\r\nimport {UpLoader} from \"../Components/Uploader\";\r\nimport {observer, useLocalStore} from \"mobx-react\";\r\nimport styled, {keyframes} from \"styled-components\";\r\nimport {useHistory} from \"react-router-dom\";\r\nimport {message} from \"antd\";\r\n\r\n\r\nconst StyleImg = styled.img`\r\nwidth: 200px ;\r\n@media (max-width: 500px){\r\nwidth: 100px;\r\n}\r\n`;\r\nconst Wrapper = styled.div`\r\nmax-width: 1200px;\r\nmargin: 50px auto;\r\nbackground:rgba(241, 243, 244,0.25) ;\r\nborder: 2px dashed #e1e1e1e1;\r\n @media (max-width: 500px) {\r\n max-width: 300px;\r\n  }\r\n:hover{\r\nborder: 2px dashed #40a9ff;\r\n}\r\n\r\n`;\r\nconst H1 = styled.h1`\r\ntext-align: center;\r\nmargin: 0 auto;\r\n`;\r\nconst big = keyframes`\r\n0%{\r\nbackground: black;\r\n}\r\n50%{\r\nbackground: red;\r\n}\r\n100%{\r\nbackground: black;}\r\n\r\n`;\r\nconst StyleDiv = styled.div`\r\nbackground: aqua;\r\nmax-width: 1000px;\r\ntext-align: center;\r\nmargin:  0 auto;\r\n//animation: 2ms linear infinite ${big};\r\ncolor: white;\r\nfont-size: 20px;\r\n`;\r\nconst Result = styled.div`\r\nmargin: 50px 100px;\r\n @media (max-width: 500px) {\r\n margin: 0;\r\n  }\r\n`;\r\n\r\nconst Home = observer(() => {\r\n  const {UserStore} = useStore();\r\n  const history = useHistory();\r\n  const widthRef = useRef<HTMLInputElement>(null);\r\n  const heightRef = useRef<HTMLInputElement>(null);\r\n  const store = useLocalStore(() => ({\r\n    width: \"\",\r\n    setWidth(width: string) {\r\n      store.width = width;\r\n    },\r\n    get widthStr() {\r\n      return this.width === \"\" ? \"\" : `/w/${store.width}`;\r\n    },\r\n    height: \"\",\r\n    get heightStr() {\r\n      return this.height === \"\" ? \"\" : `/h/${store.height}`;\r\n    },\r\n    setHeight(height: string) {\r\n      store.height = height;\r\n    },\r\n    //?imageView2/0/w/800/h/400)\r\n    get AllStr() {\r\n      return ImageStore.serveFile.attributes.url.attributes.url + \"?imageView2/0\" + this.heightStr + this.widthStr;\r\n    }\r\n  }));\r\n\r\n  const inWidth = () => {\r\n    const width = widthRef.current as HTMLInputElement;\r\n    if ((/^\\d+$/).test(width.value)) {\r\n      store.width = width.value;\r\n    } else {\r\n      message.warning(\"尺寸只能是数字\");\r\n    }\r\n  };\r\n  const inHeight = () => {\r\n    const height = heightRef.current as HTMLInputElement;\r\n    if ((/^\\d+$/).test(height.value)) {\r\n      store.height = height.value;\r\n    } else {\r\n      message.warning(\"尺寸只能是数字\");\r\n    }\r\n  };\r\n  const {ImageStore} = useStore();\r\n  const toLogin = () => {\r\n    history.push(\"./login\");\r\n  };\r\n\r\n  return (\r\n    <Layout>\r\n      <Wrapper>\r\n        {\r\n          UserStore.currentUser ?\r\n            <H1>上传文件</H1>\r\n            :\r\n            <StyleDiv>\r\n              <span onClick={toLogin}>请先登录</span>\r\n            </StyleDiv>\r\n        }\r\n        <UpLoader/>\r\n        {\r\n          ImageStore.serveFile ?\r\n            <Result>\r\n              <h1>上传结果</h1>\r\n              <StyleImg src={ImageStore.serveFile.attributes.url.attributes.url}/>\r\n              <dl>\r\n                <dt><h2> 线上地址 </h2></dt>\r\n                <dd>\r\n                  <a rel='noopener' href={ImageStore.serveFile.attributes.url.attributes.url}>\r\n                    {ImageStore.serveFile.attributes.url.attributes.url}\r\n                  </a>\r\n                </dd>\r\n                <dt><h2>可选尺寸</h2></dt>\r\n                <dd>\r\n                  <input placeholder='请在这里输入宽度' type=\"text\" ref={widthRef} onChange={inWidth}/>\r\n                  <input placeholder='请在这里输入高度' type=\"text\" ref={heightRef} onChange={inHeight}/>\r\n                </dd>\r\n                <dd>\r\n                  <a href={store.AllStr}>{store.AllStr}</a>\r\n                </dd>\r\n              </dl>\r\n            </Result>\r\n            : null\r\n        }\r\n      </Wrapper>\r\n    </Layout>\r\n  );\r\n});\r\n\r\nexport {Home};","import AV, {Query, User} from \"leancloud-storage\";\r\nimport {message} from 'antd'\r\n\r\nAV.init({\r\n  appId: \"YId6yG8LcyK0CGwLFaYIgYgf-gzGzoHsz\",\r\n  appKey: \"0IwcJacKUg9qaHmGBJrjwCC6\",\r\n  serverURL: \"https://yid6yg8l.lc-cn-n1-shared.com\"\r\n});\r\n\r\n\r\nconst Auth = {\r\n  register(userName: string, password: string) {\r\n    const user = new User();\r\n    user.setUsername(userName);\r\n    user.setPassword((password));\r\n    return new Promise((resolve, reject) => {\r\n      user.signUp().then(value => resolve(value), error => reject(error));\r\n    });\r\n  },\r\n  login(userName: string, password: string) {\r\n    return new Promise((resolve, reject) => {\r\n      User.logIn(userName, password).then(response => resolve(response), error => reject(error));\r\n    });\r\n  },\r\n  logout() {\r\n    User.logOut().then(() => {\r\n      console.log(\"注销成功\");\r\n    }).catch(err => console.log(err));\r\n  },\r\n  getCurrent() {\r\n    return User.current();\r\n  }\r\n};\r\n\r\nconst Uploader = {\r\n  add(file: File | null, fileName: string) {\r\n    const item = new AV.Object(\"Image\");\r\n    const avFile = new AV.File(fileName, file);\r\n    item.set(\"filename\", fileName);\r\n    item.set(\"owner\", AV.User.current());\r\n    item.set(\"url\", avFile);\r\n    return new Promise((resolve, reject) => {\r\n        item.save().then(serveFile => {\r\n          console.log(\"上传成功\");\r\n          resolve(serveFile);\r\n        }).catch(err => {\r\n          console.log(\"err\");\r\n          reject(err);\r\n        });\r\n      }\r\n    );\r\n  },\r\n  find({page=0, limit=10}) {\r\n    const query = new Query('Image');\r\n    query.include('owner');\r\n    query.limit(limit);\r\n    query.skip(page*limit);\r\n    query.descending('createdAt');\r\n    query.equalTo('owner', AV.User.current());\r\n    return new Promise((resolve, reject) => {\r\n      query.find()\r\n        .then(results => {\r\n          resolve(results);})\r\n        .catch(error => reject(error))\r\n    });\r\n  }\r\n};\r\n\r\n\r\nexport {Auth, Uploader};","import {observable, action} from \"mobx\";\r\nimport {Auth} from \"../Model/Controller\";\r\n\r\nclass UserStore {\r\n  @observable currentUser:any = null;\r\n\r\n  @action pullUser() {\r\n    this.currentUser = Auth.getCurrent();\r\n  }\r\n\r\n  @action resetUser() {\r\n    this.currentUser = null;\r\n  }\r\n}\r\n\r\nexport default new UserStore();","import {action, observable} from \"mobx\";\r\nimport UserStore from \"./User\";\r\nimport {Auth} from \"../Model/Controller\";\r\n\r\n\r\nclass AuthStore {\r\n  @observable values = {\r\n    userName: \"\",\r\n    passWord: \"\"\r\n  };\r\n\r\n\r\n  @action setUserName(name: string) {\r\n    this.values.userName = name;\r\n  }\r\n\r\n  @action setPassWorld(value: string) {\r\n    this.values.passWord = value;\r\n  }\r\n\r\n  @action Login() {\r\n    return new Promise((resolve, reject) => {\r\n      Auth.login(this.values.userName, this.values.passWord)\r\n        .then(user => {\r\n          UserStore.pullUser();\r\n          resolve(user);\r\n        }).catch(err => {\r\n        UserStore.resetUser();\r\n        reject(err);\r\n      })\r\n    });\r\n  }\r\n\r\n  @action Register() {\r\n    return new Promise((resolve, reject) => {\r\n      Auth.register(this.values.userName, this.values.passWord)\r\n        .then(user => {\r\n          UserStore.pullUser();\r\n          resolve(user);\r\n        }).catch(err => {\r\n        UserStore.resetUser();\r\n        reject(err);\r\n      })\r\n    });\r\n  }\r\n\r\n  @action logout() {\r\n    Auth.logout();\r\n    UserStore.resetUser();\r\n  }\r\n}\r\n\r\n\r\nexport default new AuthStore();","import {observable, action} from \"mobx\";\r\nimport {Uploader} from \"../Model/Controller\";\r\n\r\n\r\nclass Image {\r\n  @observable filename: string = \"\";\r\n  @observable file: File | null = null;\r\n  @observable serveFile: any = null;\r\n  @observable isUpLoading: boolean = false;\r\n\r\n  @action setFileName(name: string) {\r\n    this.filename = name;\r\n  }\r\n\r\n  @action setFile(newFile: File) {\r\n    this.file = newFile;\r\n  }\r\n\r\n  @action saveFile() {\r\n    this.isUpLoading = true;\r\n    return new Promise((resolve, reject) => {\r\n      Uploader.add(this.file, this.filename).then(serveFile => {\r\n        this.serveFile = serveFile;\r\n        resolve(serveFile)\r\n      }).catch(err => {\r\n        this.isUpLoading = false;\r\n        reject(err)\r\n      }).finally(() => this.isUpLoading = false);\r\n    });\r\n  }\r\n  @action reset() {\r\n    this.isUpLoading = false;\r\n    this.serveFile = null;\r\n  }\r\n}\r\n\r\nexport default  new Image()","import {action, observable} from \"mobx\";\r\nimport {Uploader} from \"../Model/Controller\";\r\nimport {message} from'antd'\r\n\r\nclass History {\r\n  @observable list = [];\r\n  @observable page = 0;\r\n  @observable isLoading = false;\r\n  @observable hasMore = true;\r\n  limit = 10;\r\n\r\n\r\n  @action append(newList: any) {\r\n    this.list = this.list.concat(newList);\r\n  }\r\n\r\n  @action find() {\r\n    this.isLoading = true;\r\n    Uploader.find({page: this.page, limit: this.limit})\r\n      .then(list => {\r\n        this.append(list);\r\n        this.page++;\r\n        // @ts-ignore\r\n        if (list.length < this.limit) {\r\n          this.hasMore = false;\r\n        }else{\r\n          message.success('加载成功')\r\n        }\r\n      })\r\n      .catch(err => {\r\n        message.error('加载失败')\r\n    })\r\n      .finally(() => {\r\n      this.isLoading = false;\r\n    });\r\n  }\r\n\r\n  @action reset() {\r\n    this.list = [];\r\n    this.isLoading = false;\r\n    this.hasMore = true;\r\n    this.page = 0;\r\n  }\r\n}\r\n\r\nexport default new History();","import {createContext, useContext} from \"react\";\r\nimport AuthStore from \"./Auth\";\r\nimport UserStore from './User';\r\nimport ImageStore from './Image'\r\nimport HistoryStore from \"./History\";\r\n\r\nconst context = createContext(\r\n  {\r\n    AuthStore ,\r\n    UserStore,\r\n    ImageStore,\r\n    HistoryStore\r\n\r\n  }\r\n);\r\nexport  const useStore = ()=> useContext(context)\r\n","import React, {useEffect,} from \"react\";\r\nimport {NavLink, useHistory} from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\nimport {Button} from \"antd\";\r\nimport {useStore} from \"../Store\";\r\nimport {observer} from \"mobx-react\";\r\n\r\n\r\n\r\n\r\nconst Wrapper = styled.div`\r\ndisplay: flex;\r\ntext-align: center;\r\nalign-items: center;\r\npadding: 20px 120px ; \r\nbox-shadow: 2px 2px 2px 0 rgba(0,0,0,0.1);\r\n @media (max-width: 500px) {\r\n padding: 0 0 ;\r\n  }\r\n  @media (max-width: 300px){\r\n  font-size: 5px;\r\n}\r\n\r\n\r\n>a{\r\ntext-decoration:none;\r\nfont-size: 2em;\r\nmargin: 0 20px;\r\npadding: 0 10px ;\r\ncolor:black;\r\nborder-radius: 10px ;\r\n&.selected{\r\nbackground: #b8dbaa;\r\n}\r\n}\r\n`;\r\nconst Text = styled.div`\r\nfont-size: 50px;\r\ncolor: #4d57af;\r\n @media (max-width: 500px) {\r\n display: none;\r\n  }\r\n`;\r\nconst StyledEntry = styled.div`\r\nmargin-left: auto;\r\n @media (max-width: 500px) {\r\n margin: 0 0 ;\r\n padding: 0 0 ;\r\n  }\r\n\r\n>span{\r\nfont-size: 30px;\r\n}\r\n>Button{\r\nmargin: 0 20px;\r\nbackground:#b8dbaa;\r\nborder: none;\r\n }\r\n`;\r\n\r\nconst StyleNavLink = styled(NavLink)`\r\n:hover{\r\nbackground: #b8dbaa;\r\ncolor: black;\r\n}\r\n`\r\n\r\n\r\nconst Header = observer(() => {\r\n  const {AuthStore, UserStore} = useStore();\r\n  const history = useHistory();\r\n  const handleLogout = () => {\r\n    AuthStore.logout();\r\n    history.push(\"./login\");\r\n  };\r\n\r\n  const handleLogin = () => {\r\n    history.push(\"./login\");\r\n  };\r\n  const handleRegister = () => {\r\n    history.push(\"./register\");\r\n  };\r\n  useEffect(() => {\r\n    UserStore.pullUser();\r\n  }, [UserStore]);\r\n  return (\r\n    <div>\r\n      <Wrapper>\r\n        <Text>Panda</Text>\r\n        <StyleNavLink to='/home' activeClassName='selected' exact>首页</StyleNavLink>\r\n        <StyleNavLink to='/history' activeClassName='selected'>上传历史</StyleNavLink>\r\n        <StyleNavLink to='/about' activeClassName='selected'>关于</StyleNavLink>\r\n        <StyledEntry>\r\n          {\r\n            UserStore.currentUser ?\r\n              <>\r\n                <span>{UserStore.currentUser.attributes.username}</span>\r\n                <Button type=\"primary\" onClick={handleLogout}> 注销 </Button>\r\n              </>\r\n              :\r\n              <>\r\n                <Button type=\"primary\" onClick={handleLogin}> 登录 </Button>\r\n                <Button type=\"primary\" onClick={handleRegister}> 注册 </Button>\r\n              </>\r\n          }\r\n        </StyledEntry>\r\n\r\n      </Wrapper>\r\n\r\n    </div>\r\n  );\r\n});\r\n\r\nexport {Header};","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {Header} from \"./Header\";\r\nimport {observer} from \"mobx-react\";\r\n\r\n\r\nconst Wrapper = styled.div`\r\nheight: 100vh;\r\ndisplay: flex;\r\nflex-direction: column-reverse;\r\noverflow: scroll;\r\n`;\r\nconst Main = styled.div`\r\nflex-grow: 1;\r\n`;\r\n\r\nconst Layout = observer((props: any) => {\r\n    return (\r\n      <Wrapper>\r\n        <Main>\r\n          {props.children}\r\n        </Main>\r\n        <Header/>\r\n      </Wrapper>\r\n    );\r\n  }\r\n);\r\n\r\nexport {Layout};"],"sourceRoot":""}